
PKG_CPPFLAGS = -Iscs/include -Iscs

# set path to SCS shared library
PKG_LIBS = -L. -lscsdir 

# set path to SCS shared library runtime location
RT_PATH = -Wl,-rpath,"$(R_PACKAGE_DIR)"/libs


# identify OS
ifeq ($(OS),Windows_NT)
	UNAME = Windows
else
	UNAME = $(shell uname -s)
endif

# get shared library extension
SHARED = $(SHLIB_EXT)

ifeq ($(UNAME), SunOS)
	RT_PATH = -Wl,-R"$(R_PACKAGE_DIR)"/libs
endif

PKG_LIBS += $(RT_PATH)


.PHONY: all scslibs

all: $(SHLIB)
	@if test  "$(UNAME)" != "Darwin"; then \
	  mv DESP$(SHARED) scsSolveSOCP$(SHARED) ; \
	else \
	  ln -s DESP$(SHARED) scsSolveSOCP$(SHARED) ; \
	fi
	@rm -rf scsSolveSOCP.o

$(SHLIB): scslibs

scslibs:
	($(MAKE) lib/libscsdir$(SHARED) -C scs)
	mv scs/lib/libscsdir$(SHARED) .
	($(MAKE) purge -C scs)



